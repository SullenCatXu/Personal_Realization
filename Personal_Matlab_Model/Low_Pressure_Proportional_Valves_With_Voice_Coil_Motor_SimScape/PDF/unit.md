#一种基于音圈执行器的呼气阀的模型设计以及带有PI控制器的复杂呼气系统性能的评估


# Model based design of an expiratory valve and voice-coil actuator and evaluation of complete expiratory system performance with a PI controller





--KTH ROYAL INSTITUTE OF TECHNOLOGYSCHOOL OF INDUSTRIAL ENGINEERING AND MANAGEMENT/英国皇家理工学院工业工程与管理学院





关键词：模型设计、通气设备、音圈执行器、磁路、边际磁通量、隔膜阀、不可压缩流





---





## 摘要


机械呼吸机是一种在危重症监护出现呼吸功能障碍时辅助呼吸的设备。呼气阀作为患者肺部压力的控制器，是呼吸机的关键部件。一种新的呼气阀组件的设计过程十分好耗时，因为可能的设计解决方案范围从音圈执行器到呼吸机种常用的膜片阀，范围广泛。





本文评估了通过设计与使用基于模型开发的分析模型来加速呼气阀组件早期设计进程的可能性。主要部件，音圈执行器和膜片阀分别进行了建模和实验验证。建立了完整的呼气系统模型和硬件在环实验装置，以此探讨对阀组件的动态特性和控制性能的预测程度。最后，讨论了有关阀组件设计的各类问题，并提出了一种新的设计，用于证明基于模型方法的能力。





最终的音圈执行器和膜片阀可视为精确到可用于快速探索设计空间，因为在无人工调整每个设计时，其误差率小于10%





关键字：模型设计、机械通气、音圈执行器、磁路、边际磁通量、隔膜阀、不可压缩流





---





## 目录


1. 介绍


	1.1 背景


	1.2 意图


	1.3 呼气系统要求


	1.4 方法


2. 音圈执行器理论


	2.1 VCA设计配置


	2.2 电磁力


	2.3 磁通量密度


	- 2.3.1 磁导


	- 2.3.2 磁体工作点


	- 2.3.3 漏磁系数


	- 2.3.4 通量密度-气体间隙


	- 2.3.5 边缘磁通


	2.4 摩擦力


	2.5


3. 音圈模型实现和测试


	3.1 坐标系


	3.2 力计算


	3.3 仿真模型


	3.4 阀模型


	3.5 硬件测试


	- 3.5.1 测试设计


	- 3.5.2 测试程序


	3.6 参数优化


4. 音圈模型结果与讨论


	4.1 结果


	- 4.1.1 力-位移关系


	- 4.1.2 通量估计


	- 4.1.3 边缘通量估计


	- 4.1.4 计算时间


5. 气-链模型


	5.1 流量理论


	- 5.1.1 流量基础


	- 5.1.2 可压缩与不可压缩流量


	- 5.1.3 伯努利方程


	- 5.1.4 流量产生的力


	- 5.1.5 电-气类推法


	5.2 肺模型


	5.3 风机模型


	5.4 阀建模理论


	- 5.4.1 阀流量


	- 5.4.2 阀力


6. 阀建模


	6.1 阀门几何形状


	- 6.1.1 流量模型


    - 6.1.2 力模型


    6.2 实验


    - 6.2.1 阀门


    - 6.2.2 设置与程序


    6.3 模型拟合与结果


    - 6.3.1 流量模型


    - 6.3.2 力模型


    6.4 讨论


    - 6.4.1 流量模型


    - 6.4.2 力模型


    - 6.4.3 假定


7. 控制结构


	7.1 控制理论


	7.2 实施


	7.3 参数调整


8. 呼气系统模型


	8.1 实施


	8.2 测试设置


	- 8.2.1 硬件


	- 8.2.2 传感器


	- 8.2.3 软件


	8.3 测试设置参数


	8.4 硬件在环参数程序


	8.5 结果与讨论


9. 系统设计


	9.1 阀门设计


	9.2 VCA设计


	9.3 薄膜附着


	9.4 设计性能


10. 总结与未来工作





---





## 1 简介





本章介绍了本论文的背景，并提出了其目的、研究问题、界定、使用方法和工作分工。本文已在位于斯德哥尔摩索尔纳的Maquet重症护理AB进行。Maquet重症护理专注于高端重症护理呼吸机和麻醉机的设计和制造，是该领域的领先制造商之一。截至2014年，该公司拥有近400名员工，年收入为1.45亿欧元





## 1.1 背景





机械呼吸机是一种在危重症监护出现呼吸功能障碍时辅助呼吸的设备。机械通气有三种基本方法，分别是负压通气、正压通气和高频通气。在负压和正压通气中，呼吸提供的频率和潮气量与正常呼吸相似，而高频通气提供的容积明显更小，频率更高。





在负压通气中，在吸气时患者的胸压低于环境压力，并在呼气时恢复到环境压力。在正压通气中，患者的口腔压力高于环境以此吸气，在呼气时，返回环境压。负压通气直到20世纪80年代初才普遍使用，之后正压呼吸机成为主导地位。本文主要关注正压通风系统。





阀控正压呼吸机的基本原理如图1.1所示。吸气路和呼气路都通过y形组件与病人相连。吸气阀控制来自高压气体供应的体积流量，呼气阀控制呼出的容积以及患者肺部的压力。





数十种不同的通风模式可根据控制变量和呼吸序列结构进行大致分类。在容积控制模式下，提供一个设定的潮气量，在压力控制模式下，吸气压力在单个吸气呼吸中保持恒定。个别的呼吸可以是强制性的，也可以是自发性的。呼吸序列可以只包含这两种类型中的一种，或者结合这两者。





无论使用的确切通风模式如何，所有的呼吸过程都具有相同的基本结构。呼吸分为吸气、呼气和保持阶段。在每次呼气结束时，肺部仍存在一个预定义的呼气末正压（PEEP），以防止患者的肺部和气道塌陷。图1.2显示了在容积扭曲模式下进行的完整呼吸。





现有的Maquet通风机采用音圈控制的膜阀，本文也使用了同样的类型。该阀门组件的主要部件如图1.3所示。膜阀是机械呼吸机中常用的呼气阀，因为膜限制了呼出的空气所造成的污染。膜阀是通过调节柔性膜和阀座之间的间隙来控制的。音线圈是电磁执行器，提供有限的线性或旋转运动。永磁铁在执行器间隙内产生磁场，所产生的力与通过位于间隙内的线圈的电流成正比。使用音圈可以实现执行器位置和阀间隙的高可控性。





![](D:\matlabworkspace\MySimscape\NIBP_Simscape\Valve\PDF\1.3.jpg)





## 1.2 目的





本文的目的是评估是否有可能利用分析模型来加快一个呼吸机的呼气阀组件的设计。该组件由一个音圈执行器和一个膜阀组成，因此必须创建这些分析模型，以便快速探索潜在的设计空间，评估控制性能，以及讨论影响系统设计的各种问题。本文的目标是通过回答以下研究问题来解决的：


- 完整的呼气系统如何能被分析地建模？


	- 是否有可能使用分析模型来解决各种系统需求？


	- 是否可以通过仿真来估计系统的控制性能？


- 音圈执行器的非线性行为如何影响呼气系统的设计和性能？





## 1.3


### 1.3.1 呼吸系统要求





呼气阀组件的要求由Maquet提出。


- 阀门应允许在压力损失低于10hPa时可通过200l/min的流量。


- 在流量为30l/min时，固定阀的压力损失不得超过3hPa。


- 呼气阀许用压力为120hPa。


- 呼气气阀允许呼气末正压在1.0--50 hPa范围内。


- 呼气末正压应在±5%或±1hPa的精度范围内进行调节。





## 1.4 方法





为了了解参考框架和文献的现状，进行了文献综述。讨论了研究结果以及开展本研究所需的理论基础。





建立了声圈执行器和膜阀的参数化分析模型。通过对模型的物理实验进行了验证。将采集到的数据与模拟性能进行了比较，并对模型进行了相应的调整。





实现了呼气系统的完整原型和一个基本的控制器。对系统的静态和动态性能进行了实验和比较，并与模拟结果进行了分析。最后，利用已验证的模型，设计了一个更理想的呼气阀装配实例。





--





## 2 音圈执行器理论





为建立一个可分析的VCA模型，必须解决由磁通量变化导致的非线性行为。该非线性是由与位置相关的磁通密度导致的，并随线圈在执行器中的运动而改变。除非线性通量外，其他力的贡献需要精确模型并模拟执行器的动态行为。这些力包括摩擦力、任何作用于线圈的力和质量导致的重力。





该节解释了VCA模型背后的理论、模型设计配置和所用假设和限制。





## 2.1 VCA设计配置





在1987年曼彻斯特大学发展了永磁驱动的新创新想法后，永磁驱动器已经成为一种非常流行和广泛使用的驱动器，应用于从扬声器到医疗设备的不同应用。随着流行，VCA的不同设计配置也可用了，对于特定的实现，每个设计都有自己的优缺点。





本文的重点是传统配置，由一个永磁体被一种高渗透性的材料包围，管状线圈绕组放置在套管和磁铁之间的间隙中，如图2.1所示。





这种配置允许当线圈绕组通电时，永磁体或线圈均可移动。这两种类型的运动都有好处，但本文中使用的执行器是所提到的第二种类型，即允许线圈移动。保持移动质量的重量较低通常是首选的类型。为了最大限度的提升永磁体的作用，VCA被设计为可在闭环中引导通量，引导磁场并迫使通量通过与通过线圈内的电流方向垂直的区域。这就产生了一个区域，称为气隙，高通量密度导致了施加在质量块上的力。为了实现封闭的磁环，永磁体被一种高渗透性的材料包围，通常是钢或铁。





由于闭环，在气隙上产生的通量密度理论上是恒定的，并该区域对执行器所产生的力贡献最大。依据执行器的设计，特别是气隙间的比例，导线和磁铁长度，这些配置导致了线圈移动至气隙外，由此造成了非线性行为。若线圈绕组被固定于气隙中，那么力系数可被认定为线性的。但对绝大多数执行器，最大行程允许线圈绕组定位于气隙外，这意味着，为了对执行器建模，需要将非线性行为纳入考虑。





除了通量密度外，VCA的力还依赖于其他因素，如温度和感应变化。VCA的温度同时影响永磁体和线圈绕组。随着温度的升高，磁铁性能发生了变化，以可逆和不可逆的方式减小磁场，同时也增加了绕组中的电阻。另一方面，感应也影响了电压的输入，减少了系统中的电流。





## 2.2 电与磁场力





VCA的平移运动的基本原理可以用洛仑兹力定理来解释电能与 机械运动间的转换。该定律表示，当带电粒子进入磁场，力辉作用于该粒子上。对平移运动执行器，这大致可表述为，当位于永磁体磁场内的线圈绕组导入电流后，一个垂直于通量方向的力将会产生，导致质量块上下运动，方向取决于电流方向。该力可表示为一个关于电流、导线长度和磁场通量密度的公式





$$ F = Bil(2.1) $$





其中,B[T]为磁通密度，i[A]为线圈电流，l[m]为线圈长度。该方程的表述方式建立在两个假设之上；第一个是，磁通量垂直于电流，第二个是，磁通量密度沿着导线的总长度是恒定的。由于VCA的设计创建了一个封闭的磁环，关于垂直通量的第一个假设可以被假设是有效的。然而，第二个假设无法对一个典型的VCA全运动行程有效。简单解释，磁体的几何形状和选择创造了一个高通量密度的区域，但在该区域外，存在边缘通量的现象，这是由于部分通量从气隙间泄露出来。这创造了在气隙外的通量密度，离气隙越远，通量越小。当线圈移动至气隙外时，系数Bl将变得非线性。为了解释通量密度的变化，我们对导线长度进行了积分，如公式2.2所示





$ F = i\int_0^l{B(x)} \,{\rm d}x (2.2) $





其中，x[m]为质量块移动的线性位移，对于传统的VCA配置，积分可以分为三个不同的积分，每个积分代表线圈在内部移动的区域的不同部分，VCA内部、气隙内、和执行器外部的通量密度。下面将更详细地描述这些近似和计算。





## 2.3 磁通密度





如公式2.2所示，使用洛伦兹力定律产生力的原理是将保持在导体中的电流引入具有高磁通量的区域中。对于传统的VCA，感兴趣的具有高磁通量的区域有三个。第一个是闭合磁路中的气隙，这个区域有最高的磁通量构成，是分析模型的主要区域。另外两个区域在间隙外，在执行器的内部和外部。为了对这三个领域进行分析建模，我们使用了两种不同的方法。对于间隙内的区域，通量密度可以利用磁导计算和泄漏近似来估计。气隙外，可使用一个标准化的近似来表示，该近似将磁通密度视为气隙距离的函数。





### 2.3.1 磁导


分析磁场回路时，磁阻和磁动势的结合形成了回路内磁通量的定义。这里的磁动势是根据以安培转为单位的线圈的绕组来表示对总磁通量的贡献的量。另一方面，磁阻表示了作为电阻储存磁场能量对磁通量的贡献。然而，如[8]所述，在分析磁路时，通常会引入电路的磁导，而不是磁阻。磁导是磁阻的导数，意味着磁导的增加会增大磁通量。通过在计算中使用磁导而不是磁阻，简化了寻找两个或多个平行通量线的等效磁阻的计算。方程式如下，2.3和2.4。





$$ (2.3) (2.4) $$





其中R1和R2为平行磁阻，P1和P2为对应的磁导。磁铁的磁导可以表示为如式2.5所示。





$$ (2.5) $$





其中，µmag[N·A^−2]为磁导率，Amag[m^2]为磁路横截面面积，Lmag[m]为磁路长度。然而，使用方程来计算通量需要假设一个理想情况，即所有通量均通过目标区域。对于带有气隙的磁路，在间隙处会发生泄漏，这会出现边缘现象，减少该间隙内的通量的大小。这种泄露可通过估计从气隙扩散的通量密度的体积来估计。VCA的几何形状决定了泄露如何扩散，可利用Roters的方法[9]来总结体积，以说明整个泄漏。图2.3说明了可用于描述总通量泄漏的不同可能的泄漏体积。对于传统的VCA设计，泄漏磁导可以用四种泄漏体积估计来表示，更准确地是Pg、Pf1、Pf2和Pf3。





### 2.3.2 磁体工作点





每一种磁体除了磁化等级外，都有它自己的特性，无论磁体的大小如何，它都遵循相同的行为。这些特征通常表现在退磁曲线上，显示了磁导和通量密度之间的关系，如图2.4所示。





在退磁图中，虚线箭头表示温度的升高，实心箭头表示磁导系数Pc的增加。从图中可以看出，对于一个特定的温度，有两条不同的曲线，本征线和正常线。普通线通常用于磁性设计。为了科学目的，固有曲线更为常见，它代表了磁体的抗磁力，包括通过磁通量通过磁体所需的部分。从正常曲线上，可以利用磁导系数找到磁体的工作点。该系数表示磁铁在正常线上工作的位置，从而给出了特定磁铁的抗磁力和通量密度。磁导系数可以用两种不同的方法来计算，要么是已经知道磁体的抗磁力力和通量密度，要么是使用磁体的几何形状。对于第一种方法，该系数可以用抗磁力和通量密度之间的关系来估计，如公式2.6所示。





$$ (2.6) $$





其中，Bd[T]为工作点的通量密度，Hd[A·m−1]为工作点的抗磁力。这种方法表明，磁铁的工作点已知。第二种方法依赖于磁铁的几何形状来估计该系数。对于开路，即磁铁放置在开放环境中，系数可以如公式2.7所示





$$ (2.7) $$





其中，Lm[[m]为磁体长度，Dm[m]为磁体直径。对于一个闭路电路，如VCA的情况，近似公式需要变化。需要包括介质的磁导率和泄漏系数。这就是等式2.8中给出的渗透系数的表达式。





$$ (2.8) $$





其中，µ为介质的磁导率[H·m^−1]，Ag为气隙面积[m2]，Am为磁体面积[m2]，Lm为磁体长度[m]，σ为泄漏系数。根据磁导系数，有 ，或者通过使用系数和反磁导率和磁体的最大通量密度来估计它。该表达式如等式2.9 [8]所示。





$$ (2.9) $$





在方程中，Br是当抗磁力为零时，回路的最大通量密度。





### 2.3.3 泄露系数





泄漏系数是音圈执行器通量估计的重要组成部分。它不仅有助于寻找磁铁的工作点，而且直接影响气隙中的通量密度的大小。泄漏系数是直接取决于磁路的总磁导与气隙本身的磁导，如等式2.10所示。





$$ (2.10) $$





其中Pt为电路的总磁导，Pg为间隙的磁导，Ptl为泄漏的总磁导。





### 2.3.4 通量密度-气隙





根据上述对工作点的通量密度和泄漏系数的估计和计算，可以估计气隙中的通量密度。该方程是磁体与间隙面积的比值与泄漏因子的组合，见方程2.11。





$$ (2.11) $$





其中，(Am为磁体面积[m2]、Bd[T]为工作点的通量密度、σ为泄漏系数、Bg为间隙中通量密度)Ag为气隙面积。该方程给出了间隙中通量密度的大小，并被认为是整个区域的常数。





### 2.3.5 边缘通量





分析模型的主要兴趣点是气隙内的通量的大小，然而，间隙外的通量密度对所产生的力也有显著的影响。由P.伯格奎斯特和L. Kemmler [3]以及Maquet重症护理中心进行的有限元分析显示了磁通密度作为位置的函数的一般形式，其中，Maquet对传统的下悬式VCA的分析如图2.5所示。

为了近似于通量密度的变化，必须在模型的准确性和复杂性之间考虑一个折衷方案。高阶多项式可以拟合不同VCA的有限元分析，但另一方面会得到一个具有大量变量的模型。图2.5所示的结果表明，可以使用某种线性近似。然而，迪特尔·格林和安德烈亚斯·施拉姆·[11]提出了一个估计函数作为边缘通量作为距离的函数。基于间隙长度和假设通量以圆形模式扩散，他们提出了一个归一化函数，如等式2.12所示。





$$ (2.12) $$





其中，Lg是间隙长度[m]，x是距离间隙的距离[m]





## 2.4 摩擦力





在平移和旋转的动态系统中，摩擦在系统的行为中起着重要的作用。在准确地表示任何系统的动态特性中，摩擦经常成为一个问题，因为摩擦的不连续行为和对两个表面之间的相对速度和法向力的依赖性。对于一个典型的音圈，移动质量通常包括一个穿过永磁体的轴，轴之间有某种轴承，如滑动或滚动轴承。这种设计会在这两个表面之间产生摩擦，并可能影响执行器的精度。精度越高，受控执行器的摩擦受外部因素作用的显著程度也受影响。由于这种现象，摩擦模型是仿真的一个重要组成部分，这允许了用户在某种程度上预测系统的响应，并在此基础上创建一个具有摩擦补偿的控制器。





精确建模和计算机功率的增加使得人们更多地关注摩擦模型和摩擦补偿。今天，根据应用程序，可以使用多个摩擦模型，包括静态模型和动态模型。动态模型的例子如达尔模型和勒格雷模型，这是由v.范格芬在中提出。





本文选择了一个基本的、可充分来模拟摩擦行为的摩擦模型。该模型包括一个静态和动态部分以及两种状态之间的过渡。所采用的模型是经典的摩擦模型，它由不同的摩擦分量组成，每个分量代表不同方面的摩擦力。该模型的静摩擦分量，通常称为库仑摩擦，与两个表面之间的法向力成正比和相反的符号，如等式2.13所示。





$$ (2.13) $$





其中，µ为摩擦系数，Fn为法向力[N]。库仑摩擦表示系统运动时的静摩擦力，但许多动态系统通常有一个摩擦力表示分离摩擦，即系统静止时摩擦力的大小，这意味着与继续移动相比，需要更高的力来使系统开始移动。





当系统不再静止时，表面之间的相对速度会影响摩擦力。为了包括这种行为，粘性摩擦作为一个组件被添加到模型中。粘性摩擦可以被建模为速度的线性或非线性函数。本文的实现是线性估计，由公式2.14给出。





$$ (2.14) $$





这里的δv是粘性摩擦系数[N·s·m−1]，v是两个表面之间的相对速度[m·s−1]。根据公式2.13 - 2.14对摩擦进行建模，其中分离摩擦给出了系统在静止和移动之间过渡的不连续行为。然而，[12]指出，斯特里贝克观察到了过渡，意味着速度依赖性，实际上是连续的。这种过渡近似被称为斯特里贝克摩擦。斯特里贝克摩擦可以近似为一系列不同的关于相对速度、库仑摩擦力与分离摩擦力的指数函数，本文中使用的近似值见公式2.15。





$$ (2.15) $$





其中，Fbrk为分离摩擦[N]，cv为过渡近似系数[s·m−1]。结合上述给出的每个摩擦估计，得到了公式2.16中给出的摩擦结论，也如图2.6（左）所示。





$$ (2.16) $$





如图2.6所示的理想摩擦图（左图），在零速度时出现不连续。因此，模型在模拟行为时会遇到计算问题。为了解决这个问题，在模型中引入了一个小的速度阈值，当速度低于阈值时，摩擦近似为与相对速度的线性比例，如图2.6（右）所示。





引入速度阈值会影响摩擦模型的精度和计算的鲁棒性。然而，实验证明摩擦力阈值在10−4和10−6之间是一个很好的折衷。阈值将摩擦模型分为两个不同的部分，该模型是由相对速度决定的方程。这两个方程显示在公式2.17中，是VCA模型中使用的最终形式。





$$ (2.17) $$





其中vth为速度阈值[m·s−1]





## 2.5 





为了降低模型的复杂性，减少计算量，结合论文内的时间约束，对模型的不同部分进行了一些局限性和假设。然而，这些划分被认为不会以任何显著的方式影响准确性。





模型输入和归纳 - 该模型由电压和电流驱动的模拟组成，其中电流输入被选择为主要输入。由于模型的预期应用，选择电流为主要输入。由于它首先是被用作测试设计解决方案的分析模型，电流输入便于分析，因为电压输入会在整个模拟过程中波动电流。电压驱动中的电感受到磁通密度变化的影响，但在模型中没有考虑到这一点，这可能会降低大位移电机执行器模型的精度。





温升 - 在VCA模型中没有实现温度升的影响。理论表明，执行器的温升会改变电特性和磁特性。然而，施耐德J.马卡罗维奇和范德莫伦格拉夫特M.施坦布奇[15]表明，与通量位置依赖性相比，在60◦C温上升时，典型洛伦兹致动器的特性变化相对较低。





磁滞(现象) - 在磁回路中，磁滞现象是表示具有磁导特性的材料中的残余磁化的常见现象。对于VCA执行器，这种磁化的幅度仍然很低，可以忽略。





线圈产生的通量密度 - 通量密度产生的线圈本身不包括在模型中。与永磁体产生的磁通量相比，线圈产生的磁通量的幅度不显著。





## 3 音圈执行器的构建与测试





为了实现和模拟上一章中提出的理论，我们使用了Matlabs的建模程序模拟链接。模拟器允许方程的可视化表示和布局，使模型更容易扩展到更复杂的系统。为了验证该模型，对不同磁体类型和几何形状的物理VCA进行了模拟模型测试。在此基础上，对边缘通量近似进行了参数优化，以进一步提高模型的精度，并在下面进行了更详细的解释。





## 3.1 坐标系





本节说明了本章中使用的坐标系。这些坐标仅在音圈执行器章节中使用，与气体链模型不同。





音圈执行器的坐标系统从其静止位置开始运动。这意味着假定线圈从执行器x=0的底部移动到最大的电机行程。这一点如下图3.1所示。





在所有的音圈图中，“距离VCA底部的距离”表示线圈底部相对于执行器底部的位置。





本章后面使用的术语涉及到执行器感兴趣的不同领域。在图3.1中标记了三个区域，其中A1被称为间隙之前或执行器内部。A2在气隙中，A3在间隙之后或执行器外部。





## 3.2 力计算





如理论部分所述，致动器产生的力是基于洛伦兹力定律，是电流、通量密度和导线长度的函数。对于传统的VCA，这个方程可以分为三个函数的总和，分别描述VCA的不同部分和每个部分对结果力的贡献。各部分的力系数见公式3.1至3.3。





$$ (3.1) (3.2) (3.3) $$





其中，Bli为执行器内部的力系数[N·A−1]，x为线圈位置的底部[m]，Bb为执行器内部的通量估计函数。Blg是间隙内的力因子[N·A−1]。最后Blo为执行器外部的力因子[N·A−1]，其中Ba为执行器外的通量估计函数。lo、lg和lo的积分极限表示每个区域中的线圈的总长度。这些结合系统电流i给出了公式3.4所示的结果力。





$$ (3.4) $$





从公式3.2中可以看出，力系数相对于间隙内的导线长度是恒定的。利用磁导估算了间隙内的通量密度。总磁导和泄漏磁导是基于气隙和磁体的几何形状。利用公式2.5，间隙磁导系数可以如公式3.5所示





$$ (3.5) $$





为了计算总磁导，必须包括泄漏磁导。对于传统的VCA，这包括三个执行器外部泄露体积和一个内部体积。这些体积近似值是基于图2.3中所示的体积近似值。总磁导是





$$ (3.6) $$





其中，每个单独的泄漏估计值如下式3.7 - 3.10所示.





$ (3.7) (3.8) (3.9) (3.10)$$





其中Dp为极片直径，Dy为轭片直径。将这些磁导计算引入到方程2.10中，可以估计出泄露系数，然后用方程2.8来计算磁导系数Pc。利用公式2.9利用磁导系数Pc求出磁体的工作点.最后，用方程2.11近似计算了气隙中的通量密度。





当气隙中的通量密度Bg已知时，可以估计气隙外的边缘通量。在理论部分中，方程2.12给出了边缘通量如何随距离而减小的近似值。然而，一些测试表明，只要VCA的设计不包括一个长音圈，这种近似是准确的。为了使对不同vca，该近似方程可行，添加了一个基于特定执行器可以优化的参数来优化方程。扩展后的方程如下式3.11所示。





$$ (3.11) $$





其中，ks是优化后的参数，它影响了坡度角度。然后将归一化后的方程与气隙磁通量Bg相乘。执行器内部和外部的力因子都使用相同的归一化函数，但由不同的优化参数ks组成。因此，力因子可以用公式3.12来表示出来。





$$ (3.12) $$





## 3.3 仿真模型





Simulink是一个使用框图环境的基于模型设计的软件程序。该程序包括用于建模和模拟动态和静态系统的求解器。由于其与Matlab的集成，该模型可以很容易地使用Matlab进行模拟和分析。Simulink界面允许使用图层来构建建模，其中每一层都包含了理论中的进一步深度。对于VCA模型，这允许模型被划分为不同的子系统，每个子系统都有自己的复杂层。VCA模型的整体Simulink设计如图3.2所示。





该模型是一个电流到力的模拟，允许用户分析特定电流输入后的动态行为。该模型还允许进一步对质量块的位置、速度、加速度等方面分析。





在模型中，没有在计算部分中提到的是法向力。为了使模拟能够在循环中正确地运行，法向力是添加运动约束的关键部分。法向力平衡了电机在工作行程和底部的执行器力。这允许模拟可以在继续在电机行程末端施加力，使得质量块保持静止。法向力是一种理想的力，这意味着材料是无限硬的。





## 3.4 阀膜





除了VCA模型外，在结合VCA和流量模型时，还加入了一个弹簧-阻尼器模型来模拟膜的行为。


膜作为两个模型之间的连接件，并平衡了执行器和呼气压力。该膜的特性被建模为一个一阶弹簧-阻尼器系统，如图3.3所示，其中执行器和压力作用于质量块的两侧。





该膜被构造为，吸气时为密封的，呼气时被打开。该膜连接到阀门上，见图3.4，并且可以选择连接或不连接到VCA上。通过将膜连接到VCA，可以将负向电流施加到执行器上，使其将膜打开。因此，当打开和关闭阀门时，膜会受到两种力的影响。然而，若将其设计为一个自由悬挂系统(膜不连接到VCA)，膜在关闭时只受到两种力的影响，在这种情况下，只有气压力可以主动打开膜。当连接这两个部分时，一个额外的质量被引入膜，并可能由于两个部分之间的不对准而增加摩擦。这可以通过使用具有特定偏移量的阀门和膜座，在膜上引入预张力来补偿，如图3.4所示。





## 3.5 硬件测试





为了验证和估计模型的准确性，我们构建了观察VCA的整个运动行程的非线性。测试的重点是VCA的力及其位置依赖性，并尽可能低的外部干扰。这意味着测试中只包括了VCA本身，而排除了膜和任何外部压力。





### 3.5.1 测试设置





该测试装置包括一个力测试系统、多个VCA和一个能够向VCA提供恒定电流的电源。该设置如图所示。





图3.5中显示的力测试系统是一个计算机控制的测试系统。使用的测试设备是一个Mecmesin多测试-电流，它允许测试范围在2N到50 kN之间，使用可互换校准的负载电池。加载单元格的精度为±0.1%，分辨率为1：6500。测试数据通过附带软件的直接导入到计算机上。为了大范围的测试在各种不同尺寸的常规VCA条件下的准确性，测试了5组不同的VCA。然而，由于具备可用规格的可用执行器的数量有限，只在同一VCA上，使用不同的永磁体进行了多次测试。表3.1列出了被测试的不同vca以及使用的不同永久磁铁。





从表3.1中可以看出，其中一个测试是用一种未知的磁体类型进行的，即测试-VCA3。然而，根据结果，磁体类型可假定为上述类型。此外，由于可用的有限元分析数据，在测试中还增加了一个仍在开发中的音圈。该VCA没有进行物理测试，所有对模拟和该VCA间的比较都是基于有限元数据。





### 3.5.2 测试方法





为了验证模型和优化模型，对不同的VCA进行了边缘通量参数估计的测试。这些测试给了力作为线圈位置的函数。在相同的音圈上进行了额外的摩擦系数的测试。这些试验分为两部分进行，一部分是寻找静摩擦力，另一部分是寻找动摩擦力。





主动测试首先将VCA牢固地紧固在力测试设备的底部，传感器尽可能靠近VCA的顶部。电源设置为输出特定的测试电流，其电压足够高以确保恒定电流。开始测试时，传感器被向上移动，移动距离等于执行器的电机行程。当VCA推动传感器时，整个电机行程中记录力，这显示了特定电流的力-位置依赖性。对每个VCA进行4次测试，输入电流分别为0.25、0.5、0.75和1A。





如前所述，摩擦试验分两部分进行。第一种是识别VCA的静摩擦的方法。这是通过断开VCA与测试设备，慢慢地使其向下，直到线圈开始移动。VCA的角度与运动部分的质量给出了静摩擦的估计。对于第二部分，寻找粘性摩擦系数，VCA再次放置在测试设备。这一次，没有任何电流被施加到执行器上，而移动质量块被连接到传感器上。然后，Mecmesin以从2 mm/min到250mm/分钟的不同速度向上拉动移动的质量。





## 3.6 参数优化





正如在VCA的理论部分中所提到的，边缘通量近似量被扩展为包含一个参数的函数，该参数使得函数的斜率更好地适用于一些具有更大的悬垂线圈的VCA。该函数的斜率系数是基于对相关VCA的测量。该参数可通过对模拟和物理数据进行比较，使用Matlabs的内置优化工具进行优化。优化是通过通过优化工具运行模拟和计算模拟和物理测试之间的均方根（均方根）误差来进行的。优化值的模拟精度如下结果章。





## 4 音圈模型结果和讨论





该结论是对一个包括传统VCA的非线性行为的Simulink解析模型。Simulink模型被构建为一个被动的系统，这意味着测试不同的VCA不需要改变模型本身。相反的，脚本被集成到模型中，允许在运行模型之前加载所有基本电机和磁铁特性。本章展示了该模型对力和通量密度估计的精度。此外，还比较了有无可调参数的边缘通量估计。最后，给出了对该模型运行的计算时间的估计值。





## 4.1 结果





结果表明，该模型遵循了实际VCA所具有的非线性行为。然而，它也表明，对于具有大的悬垂线圈的VCA，边缘通量近似公式需要优化参数，以达到足够高的精度。模型的计算时间在可接受的范围内，模拟时间是实际时间的三倍。关于模型精度的结果，对优化边缘通量参数不同的测试数据进行了分析，以确保尽可能可靠的结果。





### 4.1.1 力-位置依赖关系





根据上一章的测试，分析了不同执行器设置下的仿真精度。准确性由两部分来确定。由于磁体的自然特性，很难准确地说一个特定磁体的准确磁化程度。因此，磁化等级在一个较小跨度内表示磁通量密度和抗磁力。因此，在寻找模型的准确性的第一部中，模拟运行的目标是确定最大值和最小值，并分析实际测试是否在该跨度内。对比结果如图4.1所示。每个插图都显示了力-位置的依赖性，如图4.1所示，有两条线代表模型的结果。在这两条线之间是物理数据要定位的跨度，以使模拟准确。在分析精度的第二部分，主要集中在寻找模拟数据和测试数据之间的最大相对误差。最大相对误差是基于物理测试数据落在模拟跨度之外的最大误差。给出更精确的表示，结果见表4.1。这里所有的值都是对两种不同电流输入的测试和模拟的平均值。





平均相对误差和最大相对误差都是每个电机的两种不同电流输入的误差的平均值。为了更好地直观地表示结果，图4.1显示了对两种电机配置的仿真和物理测试。图中显示了最大电流输入为1A的力-位置依赖关系。





图4.1左侧是电动机LVCM-025-022-01执行器，它也是后来在组合模式中使用的电机，是VCA集成到物理系统中的硬件循环测试。图4.1右图显示了BEI Kimco LA152600A执行器的检测结果。





从图中可以看出，大多数运动行程中，该模型在非常准确地跟随着测试数据，但当线圈在气隙内部和外部的比值增大时，仿真结果变得不准确。





除了表4.1中提供的物理音圈执行器外，还增加了另一个执行器来测试模型的精度，Test VCA 5。在本文进行时，因为磁体还处于开发阶段，所述的音圈作为并不存在物质实体。然而，该执行器的所有性质已知，有限元分析已经模拟了其具体设计。某一电流输入下的分析模型与有限元分析之间的精度见表4.2中的。





由于执行器的性能更加精确，相较于早期测试，该测试的精度提高。力-位置的依赖关系也显示在图4.2中，以及模拟的力跨度。





在图中，测试数据说明了有限元模拟声圈，而模拟数据是来自分析模型的结果。





### 4.1.2 通量估计





计算执行器力的步骤之一是估计执行器上的磁通密度。该估计是关于最大电机行程下的从VCA底部到线圈顶部的位置的函数。由于缺乏物理测量通量的工具，需要进行有限元分析，以便准确地估计通量密度进行比较。其中一个执行器，VCA5，可利用有限元对将力和磁通量密度作为距离的函数进行分析。图4.3给出了模拟的通量密度和有限元模拟的VCA。





为了更准确地理解通量估计的准确性，VCA5的平均相对误差见表4.3。从图4.3中可以看出，气隙外通量密度减少（图中9 mm之后）的估计精度明显高于气隙前面积（0-4mm之间）的相同估计。实现的公式2.12的函数，是基于通量可以以圆形模式自由扩散的假设。可以注意到的是，磁通磁通密度在气隙前的降低，即在执行器内部，通量不能以圆形模式扩散，而是受到周围材料的限制。由于边缘通量受到执行器设计的限制，估计函数的较低斜率可以提高通量密度的总体精度，因为它可以补偿这些限制。





### 4.1.3 边缘通量估计





如上所述，无法测量测试执行器1-4的通量密度。为了直接分析通量密度估计精度，只有测试VCA 5通过有限元分析收集了必要的数据。为了分析通量估计对其他执行器的精确程度，我们将优化后的参数Ks作为分析的基础。这就意味这，在这种情况下，优化参数越多，函数斜率偏离默认值1越远，初始估计的精度越低。表4.4给出了试验执行器1-4的不同优化参数。





Ks的大小表明了边缘通量估计值的减小速度是快或慢。当Ks的值在0到1间时，表明此时通量的减少是激进的，当值大于1时则相反。从表4.4中可以看出，测试VCA1和3的优化Ks值保持在默认值1附近。这些执行机构具有原始的制造商配置，导致其磁体长度和直径、气隙面积和悬挂线圈长度均在正常的比例内。这导致了通量的边缘是正常的，其更容易预测。另一方面，测试VCA2和4的执行器设计是由于用可用的磁铁取代了执行器中的默认磁铁的结果。磁铁尺寸为音圈创造了一些不同寻常的场景，虽然仍然是一个传统配置，然而，磁铁的大小和执行器外壳之间的比例很罕见。这种设计造成了对边缘通量如何在两个方向上扩散的巨大限制，使得估计更加困难，打破了方程2.12中关于通量如何扩散的假设。这种限制和不同的边缘模式可以在这些执行器的Ks值中观察到，因为它们被大幅修改。





图4.4显示了测试VCA1的说明，左边的图显示了与优化的Ks值的力的比较，右边的图显示了相同的VCA，但默认的Ks值为1。





### 4.1.4 计算时间





对模型性能也很重要的一个因素是计算时间。为了使模型成为一个可行的选择，模拟的计算时间不能显著高于例如对同一电机的有限元分析。对于模拟时间为0.22 s的模拟，计算时间约为0.6 s，包括所有外部计算和分析结果的插图。这里给出的计算时间是在相同模拟时间下所有电机和电流输入的平均时间。





## 4.2 讨论





基于前一节给出的结果，讨论了模型的准确性和不同的通量估计，并进一步评估，以分析在多大程度上可以使用分析模型。除了这些主题之外，我们还提出并分析了创建模型的最初想法，即模型在哪个方面既满足最初的想法，也不满足最初的想法。最后，我们将讨论一些可以改进或添加到模型中以提高准确性和性能的想法和想法。





为了验证模型的准确性，使用了四个实物测试执行器和一个有限元模拟执行器。测试用执行器的选择主要基于当前可用的执行器以及提取必要数据的能力，如特定尺寸、磁体类型等。正因为如此，其中两个执行器在两个不同的测试中使用了不同的永磁体。磁铁被手动移除和替换。或许，这些磁铁的放置没有工厂精度，因此影响了测试结果。从表4.1和4.4中可以看出，与测试VCA 1和3相比，测试VCA 2和4的Ks值与默认值相比进行了大幅修改。这里表明，当永磁铁远小于电路设计预期时，边缘通量近似的假设无法满足。将这些结果与有限元模拟的VCA进行比较，已知尺寸的测试VCA 5和更传统的电路设计显示出更高的精度。通量计算和边缘通量近似是一个难以验证的值，其中包含的斜率优化参数Ks可作为精度指示。由于没有测量通量密度所需的工具，除了VCA 5外，没有评估通量的总体精度。然而，表4.4中给出的优化Ks值表明，执行器外的近似边缘通量的相对误差较低，是有效的。同样的近似被用于向执行器内部的通量泄漏，其结果不够准确。VCA内的斜率值表明，通量更集中在该区域，可以使用其他估计来代替。





从模型验证出发，提出了模型本身的基本思想。正如简要提到的，创建分析模型的原因是为了为早期模型设计创建一个模型，这意味着该模型将允许对不同的执行器尺寸进行相对快速的测试，同时显示监测力和非线性行为。由于这是关于如何使用模型的一般想法，以及论文中的时间限制，因此做出了一些限制和假设，因此模型的准确性被认为不会受到严重影响。所有这些假设和限制都列在关于音圈的理论章节的末尾。通过将模型的初始意图作为其性能的基础，可以讨论对其性能程度的估计。此外，推理模型的最佳表现以及它的局限性。在所收集的数据中，可以分析三种情况；第一个是一个音圈执行器，其设计包含了磁铁的尺寸和执行器外壳之间的传统比例，第二是磁铁和壳体之间比例较差的执行器，第三是精确知道所有尺寸的执行器。结果部分的结果表明，模型性能是最好的悬挂执行器与适当的闭环电路。这意味着磁铁和极子件与外壳的顶部对齐。由于边缘通量的假设比气隙通量更严格，说明了线圈在气隙外越多、计算约不准确的原因。但测试VCA 5表明，只要磁体长度相对较短，就可以用与外部模型相同的方程来估计执行器内部的通量，并在一定程度上进行了讨论。对于外壳尺寸和磁体尺寸之间有很大比例差异的情况，模型开始变得不准确。随着模型的动态行为开始偏离物理模型，边缘通量估计需要有更大程度的改变。





基于这些观察结果，该模型可以被认为是足够精确的初始设计测试，特别是在关于 Maquet Critical Care数学重症护理的要求范围内。执行器外的边缘通量估计足以满足通量衰减和间隙内通量的计算。然而，执行器内部的边缘通量在磁体长度相关的有限范围内工作。随着长度的增加，通量近似精度减小。这表明可以使用另一种近似来代替。





## 5 气路模型





本章介绍了基本的流量理论，模拟病人的肺和呼气管。最后讨论了膜阀模型，并给出了现有的阀门模型。





## 5.1 流量理论





本节介绍了模拟呼气流的基本概念.





### 5.1.1 流量基础





流动是由剪切力引起的流体的连续运动。剪切应力通过允许流体的分子层相互滑过而引起流动。流动可以是层流的或湍流的。在层流中，流体粒子沿直线流线运动，而湍流更为混乱，粒子沿不规则的缠绕路径运动。无论流动是层流还是湍流，都可以用雷诺数来确定，定义在（5.1）中。





$$ (5.1) $$





其中，ρ为流体的密度，v为流速，Dh为流体通道的等效直径，µ为流体的动态粘度.动态粘度描述了由剪切力引起的流动的阻力.如果Re < 2000，则流动可以考虑完全层流，而Re > 4000意味着流动是完全湍流的。介于两者之间的值代表了层流和湍流之间的过渡区。





流量可以进一步分为稳态流量或非稳态流量。稳定流意味着流量的任何参数都不随时间变化。完全稳定的流动很少存在，但绝大多数的流动可以像它们是稳定的一样进行分析。基于定义，湍流不是稳定的。然而，它们可以被认为是随着时间的推移而稳定的平均值。





### 5.1.2 可压缩和不可压缩的流量





流动理论的复杂性很大程度上取决于流动是可压缩还是不可压缩。可压缩流体的密度取决于压力.大多数液体在正常压力下是不可压缩的。然而，气体遵循理想气体定律（5.2），并且密度的变化显著。





$$ (5.2) $$





其中Rs是比气体常数，p是压力，T是气体的温度。密度取决于压力和温度，因此热力学规则必须包括在可压缩流动理论中。因此，描述可压缩流比不可压缩流复杂得多。





在某些情况下，可压缩流可以近似为不可压缩流。这个近似是否准确可以用马赫数来确定.它描述了流速和声速之间的比值。如果马赫数小于或等于0.3，则流量可以近似为不可压缩的，因为密度的变化小于5%。





$$ (5.3) $$





其中c是声速。如1.3.1中的系统要求所述，阀必须能够为成人患者提供200 l/min的最大流量。假设声速为340 m/s，用平均速度计算的马赫数为





$$ (5.4) $$





其中，Q为体积流量，A为气体流动的横截面积。现在，马赫数为0.3所对应的面积变成了





$$ (5.5) $$





这相当于一个直径约为6.5毫米的圆形管。成人气管内管的内径为7 mm.这意味着流动可以近似为不可压缩的。假设整个呼气系统可使用该假设。





### 5.1.3 伯努利方程





如果流动无摩擦且稳定，密度没有变化，流动中没有传热，流动与周围环境之间没有能量传递，则沿流动流线传递的机械能是恒定的。这种能量传输可以用伯努利方程来描述





$$ (5.6) $$





其中v是流速，g是重力加速度，z为相对于设定的基准水平的高度。如果高度的变化很小或流体的密度很低，则可以忽略最后一项。伯努利方程假设密度是恒定的。然而，如果密度的变化很小，这也是一个很好的近似值。通常用于气体的形式变成了





$$ (5.7) $$





根据理想气体定律（5.2）和系统要求，阀内空气密度的变化不应超过12%。因此，可假设伯努利方程适用于整个呼气系统。





### 5.1.4 流量产生的力





流动对表面施加的力取决于压力和流动惯性的变化。压力简单地作为表面积的一个积分。惯性力可以从稳态流动的动量方程中得到。因此，由流动所施加的总力就成为了





$$ (5.8) $$





### 5.1.5 电-气模拟





肺和呼气管的动态行为在阀控制中起着重要的作用，因此它们必须被建模以模拟整个呼气系统。早在20世纪中期，人们就认为一个气动回路，就像呼气系统，可以用类似于一个集总参数电路来近似。同样的类比也可以用于血管的建模。气动电路和电气电路之间的量转换见表5.1。基尔霍夫电压定律都适用于这两种电路。根据博雷洛[22]，本节中提出的类比允许系统分析和控制设计的足够的近似精度。





流动阻力R解释了流动中损失的能量。对于层流，粘性力占主导地位，而在湍流状态下，惯性力占了大部分的损失。如前所述，流动阻力通常不是线性的。例外的是圆形横截面上的层流，它遵循哈根-泊肃叶公式。在这种情况下，长度l的压力损失变成





$$ (5.9) $$





其中µ为流体的动态粘度，包括长度和管的直径。因此，流动阻力就变成了





$$ (5.10) $$





对于湍流和更复杂的形状，压力损失遵循达西-韦斯巴赫方程





$$ (5.11) $$





其中，ζ为压力损失系数，w0为流速，ρ为流体密度。ζ是一个实验系数，其值可以通过实验确定，也可以从表格中检索。





顺应性，通常表示为C，描述了气体的可压缩性和容器的弹性。如果容器体积的变化相对较小，则顺应性可以近似为一个常数值，并描述为





$$ (5.12) $$





其中，Vc为容器体积和p0环境压力。





流体的惯性率，L，表示运动流体的惯性效应.惰性对长管的动力学有显著影响，但对于较小数量的流体，因此较低的质量，流动阻力和顺应性足以描述大部分的行为。管路的惰性率可以描述为





$$ (5.13) $$





其中是lt是管的长度和At横截面积。





## 5.2 肺模型





人体的呼吸机制是一个非常复杂的过程，全面的理解需要对肺中的三种不同的现象来建模。第一部分是肺和气道力学。其次，模拟通过肺部的血液循环。最后一个是肺部血液和空气之间的气体交换。对于本文，理解肺和气道力学就足够了。





现有的肺-气道模型的复杂性各不相同。最简单的一种是假设肺是一个刚性的单室容器。更复杂的模型可能包括肺的灵活性、胸部的惯性以及气体的惯性。也可以将两个肺建模为单独的隔间，并解释气道的可折叠部分。





为了捕捉呼吸的动态行为，通常认为将肺建模为rc电路是足够的。该模型的等效电路如图5.1所示。对于正常的呼吸频率，肺的惯性影响可以忽略不计。在快速呼吸时，惯性力可能会变得显著。然而，包含惯性分量并不总是能得到更好的近似。





健康成人肺的顺应性、阻力和时间常数的典型值为





$$ (5.14) $$





肺的性质因病人而有很大的不同。患病患者的肺顺应性可能会降低或增加，而新生儿的肺和气道则明显小于成人。Borrello表明不同患者的时间常数可能在0.01秒-100秒之间变化多达四次量级。





RC电路一般是一种简化，因为肺的气阻不是线性的，顺应性随体积变化。Otis已经确定，肺的总血流阻力被更准确地描述为





$$ (5.15) $$





其中R1为一阶流动阻力，R2为二阶流动阻力。如果顺应性是恒定的，那么肺的压力-体积曲线将是一条直线.然而，该曲线遵循图5.2所示的s型函数。压力-体积关系在吸气和呼气之间也存在一定的滞后现象.





## 5.3 管路模型





患者和呼气阀之间的管路对整个系统动力学起着重要的作用。管中空气的惯性和它们的刚性顺应性可能会产生高频振荡。导管的流动阻力会导致阀门和肺之间的压力差，从而影响阀门的控制。这些管子通常用第5.1.5节中提出的电-气动类比来进行描述。





现有的油管模型的复杂性差别很大。纪尧姆和博雷洛使用三阶RLC电路来描述管路，而博雷洛后来使用使用一个简单的RC电路来实现相同的目的。2012年，伯格奎斯特和凯姆勒在他们的论文中使用了8个单独的二阶RLC电路来描述管，以捕捉管中驻波引起的高频动力学。更复杂的流体系统可以被建模为一个简单的RLC-电路的组合。可以通过以不同的方式分布RLC组件来构造不同的元素，如图5.3所示。





## 5.4 阀模型理论





在本节中，讨论了对膜阀的建模。呼气膜阀的简化几何形状如图5.4所示。入口管通过一个y形管与病人相连。通过阀门的流量被移动膜限制，移动膜限制了阀门入口和出口之间的气道大小。通过改变阀座和阀膜之间的间隙x来控制入口处的压力。





一个完整的阀门模型必须描述通过阀门的流量以及施加在阀门膜上的力。下面几节将讨论现有的阀门模型。本讨论分为两个子部分，流动模型和力模型。





### 5.4.1 阀流量





博雷洛和Li认为，使用孔板方程可以足够准确地近似通过阀门的质量流量。博雷洛提出的见公式5.16





$$ (5.16) $$





其中，γ为所有双原子气体的比热比(绝热指数)，比热比为1.4，∆p为阀门的压差，p1为阀前压力，A12为孔板的等效面积，γsw表示气体的比重。阀门上的压力差在0...120hPa之间变化。（5.16）的第一部分的对应值在1...0.98之间，因此可以近似为1。





如果使用平均孔口尺寸，通过阀门的体积流量可以用以下形式表示





$$ (5.17) $$





Smal【31】研究了通过微型泵中使用的微型阀的流体流动。所述阀与呼气阀具有相同的简化几何形状。在他们的研究中，他们开发了一个解析流体流动模型，并将其性能与有限元模型进行了比较。





对两种模型进行了实验测试，并获得了相似的精度。





然而，解析模型的计算只花费了计算有限元模型所需的模型时间的4%。结果表明，解析模型是模拟具有相似几何形状的阀门的一个更好的选择。





Smal的模型假设在阀门入口和间隙中的流量都是层流的，并且在阀门出口中没有发生压力损失。利用伯努利方程可计算阀门不同点处的压力。其在膜上的压力分布如图5.5所示。不同的压力为：





$$ (5.18) $$





其中，ζ(x)是描述由圆盘上的流动偏差引起的压降的流量因子。流量系数值取决于阀门间隙与进口直径之间的比率。





该模型将通过阀间隙的流动近似为两个矩形板之间的层流。通过这个间隙的体积流变成了





$$ (5.19) $$





其中，x为阀门间隙开口，pc为环境压力。





### 5.4.2 阀的力





施加在薄膜上的力对阀门的控制至关重要，因为它会影响所需的驱动力。最简单的，也是最常见的方法，是考虑与阀门入口面积和压力成比例的力。由此产生的压力力是





$$ (5.20) $$





其中，Cv是描述膜上压力分布的阀系数。另一种方法为，在Smal的模型中，是通过对膜面积上的分布压力积分来近似力。Smal所使用的分布（5.21）和图5.5所示





$$ (5.21) $$





因此，在Smal的模型中产生的压力是





$$ (5.22) $$





上面讨论的两个模型都没有包含第5.1.4节中提到的惯性力.简单的压力力只依赖于入口压力，而Smal的力模型则间接地依赖于阀门的开度，因为这会影响压力的分布。





## 6 阀模型





本章建立了描述阀门流量和力的最准确的模型。对第5.4节中描述的现有阀门模型进行了扩展，以更好地匹配实际的阀门几何形状，并进行了实验测量，并相应地调整了模型。最后对不同模型的性能进行了评价。





## 6.1 阀的几何形状





本文中使用的阀门几何结构是由伯格奎斯特和凯姆勒在早期的硕士论文中提出的。几何图形称为uturn。在这个几何结构中，流量的方向在撞击阀膜后变为相反。该几何图元如图6.1所示。





为了匹配几何形状，必须扩展5.4中提出的模型。





### 6.1.1 流量模型





采用喷嘴方程和Smal流动模型的比较。考虑到这样一个事实，流量模型的第一个扩展是，即不可能测量阀门入口内的压力，而是在入口之前测量。根据伯努利方程，压力测量点的直径可能与入口直径不同，从而导致压力差。测量的压力pin与阀门进口压力pvi之间的关系可以表示





$$ (6.1) $$





假设测量点与阀门入口之间发生其他重大压力损失，压力损失因子ζin由伯努利方程和（6.1）推导出，结果为：





$$ (6.2) $$





当将其纳入喷嘴方程（5.17）时，流量变为：





$$ (6.3) $$





流量模型的合并是基于一个更复杂的压力分布，因此有必要包括阀室和出口之间的压力差。当这一点被计算在内时，阀室的压力pc就变成了。





$$ (6.4) $$





结合方程（5.18）、（5.19）、（6.1）和（6.4），扩展的Smal模型变为





$$ (6.5) $$





根据实验结果，调整了喷嘴方程中的流量常数Cd和与阀隙相关的流量因子ζ（yr）。








### 6.1.2 力模型





所测试的力模型为恒压力、变压力、变形力和扩展变形力。所有的力模型都用惯性力进行了评估。阀门的惯性力为





$$ (6.6) $$





恒压力定义为式（5.20），阀门系数Cv不变。在变压力-力模型中，力-系数为阀的间隙和入口直径的相关的函数，类似于Smal流模型。变压力-力模型如下式所示。





$$ (6.7) $$





smal力模型的压力用公式（5.22）表示。标准版本采用公式（5.21）中提出的压力分布.在扩展的力模型中，压力分布是一个与阀间隙-直径比值相关的可变多项式函数。因此，系数a1和a2也发生了变化。扩展的smal模型和变化的系数描述如下。





$$ (6.8) $$





## 6.2 实验





为了调整、验证和评价前一节中提出的模型，我们进行了物理实验。





### 6.2.1 阀





实验是在三种不同的阀门上进行的。其中两个阀门是3d打印的10毫米和14毫米入口直径的阀门原型。第三个是入口28毫米的Maquet伺服呼气盒的阀门。





与uTurn阀相比，伺服阀在膜前的垂直入口部分明显更短。不同阀门的主要尺寸见表6.1。





### 6.2.2 设置与实施





测试设置如图6.2所示。瓣膜和膜附着在Mecmesin MultiTest 1-i上。


从压力供应器向阀门供应一个设定的压力。压力通过使用Huber仪器HM-35 的黄铜连接器进行测量。该连接器的内半径rin为8.3mm。采用TSI-4040流量计测量。膜的位移和施加在膜上的力都是用Mecmesin MultiTest和一个50N的测力单元来确定的。





测试程序的初始化设置为阀门的零开度。这个状态定义为，通过挤压阀膜靠近阀座，直到没有或极少泄漏流量。阀门入口前的压力保持不变，同时膜和阀座之间的间隙逐步增加。测量每个开口的阀门流量和力。对不同的压力差重复了相同的程序。共获得676个测量点，分布在10mm uTurn、14mm uTurn和28mm伺服阀之间，分别为150、425和101次。





## 6.3 模型拟合与结果





本节讨论了模型的拟合和结果。与实验数据相拟合的不同参数分别为





扩展喷嘴方程的排放系数Cd（6.3）


扩展的Smal流量模型的压力系数ζ（yr）


变压力力的力系数Cv（yr）


扩展的Smal力模型的压力分布指数n（yr）。





### 6.3.1 流量模型





排放系数Cd通过最小化测量体积和预测体积流量之间的总均方根（rms）误差来拟合。最后三个系数是间隙-直径比的函数，它们分为两个阶段拟合。首先，确定使每个比率的均方根误差最小的值，然后拟合一个函数来匹配这些值。





测量了模型的均方根误差、绝对平均误差（ame）和平均绝对百分比误差（mape）。所确定的膜的零点位置并不是绝对准确的。此外，还计算了流量模型的间隙阈值绝对平均百分比误差。将阈值设置为忽略小于0.07mm的间隙。我们分别计算了每个阀门的指标和一个总值。





当排放系数Cd为3.02时，喷嘴方程的误差最小。结果误差如表6.2所示





对于扩展的smal流模型，确定了压力损失系数ζ（yr）。图6.3显示了每个测量值间隙误差最小的值。





根据结果分布，函数估计为幂或指数函数。除实验值6.3外，该系数的表值。利用Matlab的曲线拟合工具箱确定了最优函数。我们测试了以下三种形式：





$$ (6.9) $$





指数函数、幂函数的rms-erros分别为92.5、18.2和12.7，组合版本的效果最佳，最终压力系数为：





$$ (6.10) $$





扩展smal流模型的误差如表6.4所示.





### 6.3.2 力模型





仅基于10mm uTurn和28mm伺服阀对力模型进行了评估和匹配，因为10mm uTurn的几何形状最终不能代表所使用的模型。这个问题将在本章的讨论部分进行进一步详细的讨论。





通过调整惯性系数来调整简单的压力，以最小化均方根误差。惯性系数k = 1的效果最好，数值见表6.5。





变压力力模型包含与隙径比相关的压力分布系数Cv（yr），已基于实验拟合。图6.4显示了减少不同比率的均方根误差的系数值。





对数据拟合一个多项式函数，均方根误差为0.061。所得到的函数是三阶多项式，显示在（6.11）中。调整的可变压力模型的最终误差如表6.6所示。





$$ (6.11) $$





Smal力模型不需要拟合，结果见表6.7





最后对扩展的Smal力模型进行了评价。压力分布指数n（yr）的拟合与Smal流动模型中的系数相似。最终拟合的指数函数的均方根误差为2.54，见（6.12）。其分布和拟合函数如图6.5所示。





$$ (6.12) $$





## 6.4 讨论





在本节中，选择最佳拟合流和力模型，重新考虑模型假设，并分析模型性能





### 6.4.1 流量模型





当间隙大于0.07 mm时，这两种流动模型都具有良好的精度。然而，低于这个阈值的表现明显更差。小间隙的性能差可以解释为难以确定零间隙，由于压力导致的柔性阀膜变形和膜的小偏差。





明显更复杂的Smal流模型在所有阀门的每个度量上都优于喷嘴方程。28 mm伺服阀和小间隙的改进最大。这些都如图6.6所示。关于喷嘴方程的相对性能改进见表6.9。





选择Smal流量模型作为阀门模型的流量部分。该模型在误差小于5%的较大间隙时非常准确。然而，对于较小的间隙，误差略高于10%。10mm-和14mmu旋转阀的性能如图6.7所示。为了进一步改进流动模型，需要进行更多的小间隙测量，并研究膜性能对流动的影响。





### 6.4.2 力模型





不同力模型的性能在比较模型中差异很大。Smal模型的误差超过25%，不能作为阀门的代表。对这一结果的解释将在稍后的重新审视模型假设时进行解释。





两个最佳的力模型分别是间隙相关的变压力模型和扩展的Smal力模型。表6.10总结了这两种模型之间的性能差异。在14mm uTurn阀上，变压力模型优于扩展Smal力模型，但对28mm伺服阀明显较弱。变压力模型无法描述这两个阀门，如图6.4所示。





选择扩展声力模型作为阀门模型的力部分。图6.8显示了最终的力模型性能。


为了进一步改进受力模型，还需要测量更多的阀门。此外，阀门几何形状上的微小差异可能会对阀门的力产生很大的影响，因此必须谨慎使用力模型。





简单的压力不应该需要拟合。然而，建模的力显示了，随着流量的增加，力也增加了较多。因此，如结果中所述，惯性系数是拟合的。这导致其性能提高了18.6%。图6.9演示了此模型的调整版本和未调整版本之间的区别。





如结果部分所述，力模型不适用于10mmu旋转阀原型。在10毫米的原型中，在出口通道和膜之间有一个角落，在那里流速为零。根据伯努利定律，这增加了在角落对pt的压力，由此施加在膜上的力以一种在力模型中没有考虑到的方式增加了。其效果如图6.10所示。图6.11显示了10 mm uTurn阀门的不良性能。





### 6.4.3 假设





本章中讨论的所有模型都是基于流动的不可压缩性的假设。在较高的压力下，流量的最大马赫数仅略超过0.3，并且在大多数测量中保持显著较低。因此，在阀门的工作范围内是不可压缩的。





Smal模型也假设了该流动是层流的。然而，这一假设在整个测量过程中并不完全成立。这就解释了Smal力模型性能不佳的原因。扩展的Smal模型的调优过程否定了错误假设的影响，即使膜上的压力分布不能被认为是准确的，最终的性能仍是优秀的。11mm uTurn阀的马赫数和雷诺数如图6.12所示。





## 7 控制系统





如前言所述，本文采用的机械通气方法为正压通气。通风类型的基本原理见图1.1，本节讨论的重点是呼气阶段。这个想法是控制呼气阀前的测量压力朝向特定的呼气末正压，以保持肺部相同的压力。对于此控制，必须满足以下要求。





应达到呼气末正压值的完全精度。


调节呼气末正压值的最大误差应为± 5%或± 1 cmH2O≈98Pa（以较大者为准）。呼吸频率超过60 B/min，允许误差为±2 cmH2O。


在任何呼气点，肺压的误差不得高于上述值。





基于这些要求，实现了一个pi控制器。由于控制器的主要目的是创建一个稳定的呼气阶段来验证模型，控制器是在有限的流量、压力和测试肺范围内构建的 。测试控制器的流量在4-12L/min之间，呼气末正压在200-1000pa之间。所有的测试都是在一个静态测试系统上进行的，测试的肺活量为1l。





关于控制系统的结果在呼气系统设计部分进行了分析，其中模拟系统和测试系统都与控制器一起使用。





### 7.0.1 控制理论





为了机械地给病人通气，可以根据方法、压力或基于容积的通气方式使用不同的控制器。由于焦点是呼气阶段，在创建控制器时只考虑压力控制方法。这通常被认为是一种比较难控制的通风方法之一，因为肺参数的变化比其他方法更能影响控制响应。





历史上，基于压力的通风使用传统的PI控制器补偿。对于一个理想回路，这意味着在系统中不考虑泄漏，一个PI控制器可以为所有不同的气阻和顺应性提供一个稳态误差为零的设置值。然而，控制器的行为也表明了在系统中有超调的可能性。对于这种类型的控制器，在尝试控制具有不同电阻的系统时会出现该控制器问题。为了对小气阻的系统有足够好的响应，当控制器的比例部分保持不变，大气阻的系统会产生震荡效应。一个可能的解决方案是实现一个自适应控制器，其中比例值适应根据系统参数的估计。





随着微控制器处理器速度的不断提高，可以考虑和实现更先进的控制结构。由圣保罗·侯、纳德·梅斯金和瓦西姆·m·哈达德[34]提出的一种方法是实现一个自适应滑模控制器。这是为了解释非线性的肺参数。控制器的思想是，在不知道系统的不确定性和扰动界限的情况下，通过让控制器学习和适应每次呼吸，给出更准确的结果。然而，这种方法没有进一步研究，因为PI控制器的选择对该系统是足够的。





### 7.0.2





由于对控制器的工作范围设置了限制，因此决定实现传统的、没有自适应比例部分的PI控制器。控制器要操作的系统是一个恒定的测试设置和有限的流量和压力范围，在本部分的开始部分详细给出。除了传统的PI控制器外，在结构中还增加了一个扩展部分，以补偿可能的摩擦和膜预紧力。这包括一个被引入到控制信号中的偏移值，如图7.1所示，并且可以被视为基于系统知识的前馈部分。





对于具有高摩擦或膜预张力的系统，控制器需要更激进，以便快速打开阀门。作为回报，当控制器试图稳定在呼气末正压值时，这可能会给出一个更大的超调和更多的振荡行为。引入偏移补偿外部力量，允许控制器的激进性和降低振荡。





在一个理想的系统上实施这种控制器，肺压力设置在可接受的呼气末正压范围内。然而，对于一个物理系统，由于不同的因素，如管连接不良，膜错位等，可能会发生一些泄漏。这意味着，当测量的压力达到PEEP值，控制器关闭阀门以保持该值时，但压力由于泄漏而下降，最终在参考PEEP以下终止。为了补偿这种行为，有两种不同的方法进行了测试；自适应呼气末正压参考和偏差流。





对于自适应呼气末正压参考，其思想是基于早期呼吸的稳态误差来提高参考呼气末正压的值。这里的误差是在呼气阶段结束时，就在下一次吸气开始之前，并添加到下一次呼气的参考值中。这允许控制器根据最后一次呼吸的误差来调整参考压力。在静态肺和动态肺上实施和测试这表明，自适应呼气末正压参考应该是之前多次呼吸的平均值，而不仅仅是前一次呼吸。这是为了防止系统在前一次呼吸中发现突然的变化时进行过度补偿。





另一种方法是使用偏差流。这已经用于伺服阀，它允许系统在整个呼气阶段不断地提供一个较低的吸气流。即使系统中有泄漏，只要偏置流大于泄漏流，也允许肺达到呼气末正压值。自适应PEEP参考和偏置流的影响如下图7.2所示。感兴趣的区域用图中的虚线表示，其中显示了压力的沉降值。对于这两个图，参考PEEP值都设置为800 P a。





### 7.0.3 参数调整





为了调整控制器的比例和积分部分，选择使用Matlabs内置的PID调节器。PID调谐器基于Simulink中内置的工具计算线性模型。参数调整是通过选择系统响应及其瞬态行为来完成的。这意味着响应时间以及控制器应该是侵略的还是鲁棒的。基于线性化模型，调整工具给出了系统行为的指示；可能的超调，上升时间和稳定值。





为了利用这种工具，我们建立了气体链模型和线性音圈执行器模型。初始调优是基于性能和鲁棒性之间的良好折衷，以及可接受的响应时间。为了最终完成调优，控制器被实现到物理系统中，其中比例部分和积分部分被进一步手动调优，以提高控制器的性能和精度。





## 8 呼气系统模型





为了评估所实现的VCA和音圈模型是否足够精确，是否可以用于阀门组件设计和控制器评估的早期部分，对一个完整的呼气系统进行了建模和模拟。本章讨论了完整的呼气系统模型、实验试验和所取得的结果。





### 8.1 实施





为了模拟整个呼气系统，需要建立一个组合系统模型。该组合模型包含了第3章设计的VCA模型、第6章设计的阀门模型和下面描述的气体链模型。





气体链模型由患者的肺、呼气管和瓣膜组成，并根据第5.1-5.3节中描述的肺模型、呼气管模型和电-气模型进行设计。外部输入，吸气流Qinsp在肺和导管之间引入。





肺阻力和气管阻力都被建模为二阶气阻。该阀被建模为一个可调的电阻器。气体-气路模型如图8.1所示，





描述气体链模型的动力学特性的方程如下图所示。





$$ (8.1) (8.2) (8.3) (8.4) (8.5)$$





组合模型之间的接口如图8.2所示。阀模型根据阀的输入压力pin和阀间隙x提供阀流量Qv到气链模型，提供Fflow到VCA模型。VCA模型通过坐标转换提供阀门间隙。组合模型的外部输入是吸气流量Qinsp和VCA输入电压。





## 8.2 测试设置





为了验证呼气系统模型，我们选择了一个硬件回路（HIL）测试装置。这种方法提供了实时测试复杂系统的机会。设置包括以下物理系统；呼气执行器，管路，测试肺和呼气阀，以及测试控制响应的软件平台，整个设置如图8.3所示。





HIL测试设置包括整个呼吸周期，这意味着它允许吸入和呼气。然而，测试的重点是系统的呼气周期。





### 8.2.1 硬件





在测试中使用的呼气阀是基于P.伯奎斯特和L.凯姆勒[3]提出的设计，称为uTurn阀。该设计允许使用一个较小的阀座来降低关闭出口的力要求，此外，由于它的设计，它也作为一个集水器，迫使水流在离开阀门前做一个u型转弯，见图6.1。为了测试将VCA与膜连接的PI控制器，我们对设计进行了两次修改。第一个是扩展阀门的底部，为执行器创建一个座位。这是包括为了将VCA集中到膜上，然后连接这两个部分。该设计的第二个扩展是降低阀门中的膜座，从而形成一个预张力来抵消重力，见图3.4。图8.4所示是测试中使用的呼气阀设计，包括膜和执行器。





在图中，膜用红色表示，执行器用蓝色表示，膜附着用绿色表示。





在测试中使用的音圈执行器是动机LVCM-025-022-01，测试VCA 1。选择这个致动器是由于它在VCA测试中显示的非线性行为。非线性行为是可取的，因为测试的一个有趣的方面是找出一个非线性的VCA是否会对致动器的响应和间隙开口的可控性产生显著影响。执行器从套管的底部偏移约3毫米。作为回报，这设置了最大阀门开启度的限制为3毫米。





在控制信号和VCA之间增加了一个放大器，以将来自dSPACE系统的控制信号放大到执行器的可接受范围内。使用的放大器是Maxim MAX9736A评估工具包+，是一个单声道/立体声高功率D级放大器，工作范围为8V到28 V [35]，能够提供负电流和正电流。放大器的默认配置是一个交流信号，但是通过去除输入端口的两个电容器，放大器可以用于直流信号。





用于吸入的气体模块与今天在伺服-i中使用的相同。该模块仅用于向肺充满特定的流量，以物理测试系统的呼气循环。





### 8.2.2 传感器





为了分析系统中的流量，流量传感器色设置于在阀和膜之前。使用的传感器是TSI 4040质量流量计，其范围在0到300L/min之间。该传感器的精度为±2%或0.05l/min，在全尺度流量的63%内其响应时间为4ms。





与流量传感器一起，使用了两个压力传感器来分析系统的行为。其中一个传感器被放置在连接肺和吸入和呼气管的y形管处。第二个传感器被放置在阀和膜之前，与流量传感器的位置相同。所使用的压力传感器与 Servo-i中所使用的压力传感器相同。





### 8.2.3 软件





完成硬件平台后，dSPACE连接到系统。可同时提供控制信号以及读取传感器的值。dSPACE包括一个软件和硬件解决方案，通过与Matlab集成，可实时读取和控制系统行为。该集成允许用户创建一个包含特定测试要点的Simulink模型，其中包括特定的输入读取、输出特定的信号或与物理系统实时运行模型。集成软件RTI（实时接口）允许选项在测试运行时更改模型内部的值，包括控制器参数、输出信号等。





## 8.3 测试设置参数





为了进行仿真，每个模型都需要一些物理系统参数。气体链参数是测量和近似于测试设置的，而阀门模型参数直接来自其几何形状。最后，通过测量所选择的VCA和阀膜来获得VCA参数。





通过填充固定体积流量时测量y片压力来测量肺阻力和顺应性。顺应性的近似是基于体积流量和压力梯度，如公式（5.12）。从关闭吸气流量时压力的突然变化中可以看出气阻。该过程如图8.5所示。





管路的阻力是通过测量管上发生的压降来确定的。图8.6显示了肺和导管的测量结果和已实现的阻力。





根据公式（5.12）和（5.13）计算了气路的顺应性和惯性，气路的长度和直径分别为1.1m和2cm。气链的模拟参数为：





用于设置的阀门是一个新的uTurn阀，入口直径为14毫米。阀门出口处于环境压力下。阀膜被预紧为紧靠阀座的状态，以实现止回阀功能。使用Mecmesin1-i估计了最终的预张力Fpt、膜的弹簧常数和阻尼系数。阀门的尺寸和阀膜参数列于表8.2和表8.3。





## 8.4 硬件测试程序





为了研究系统的性能，我们进行了静态和动态测试。使用静态测试是为了找到上述系统的参数值，而动态测试则给出了系统响应的一个更全面的说明。





静态测试是通过通过系统提供特定的流量，同时让执行器以特定的电压打开阀门。整个系统都包括在这些测试中，从吸气气体模块到呼气阀。使用三种不同的执行器电压进行三次测试，一次测试-0.25 V，第二次测试-0.5 V，第三次测试电压保证阀门全开，-2 V。每一种测试的流量从零开始，作为阶梯函数增加到100升/分钟，见图8.7。





在验证了模型的静态特性后，将验证扩展到系统的动态测试。这里包括了整个呼吸周期，其中呼气行为由一个实现的PI控制器控制，在前一章中有更详细的解释，以及吸入阶段，它只包含一个预定时间内的特定输入流。采用不同吸气流量呼吸试验肺，结合多个呼气末正压值进行试验。吸气流量在4l/min~12l/min之间，呼气末正压压力在200Pa~1000Pa之间。对三种不同的控制方法进行吸气流和PEEP压力的每种组合；使用传统的PI控制器，将PI控制器扩展为自适应PEEP参考压力，最后加入1l/min的偏向流。每次测试进行的时间段为20秒，允许系统完成5个呼吸周期。每个呼吸周期为4秒，分成1.5秒的吸气时间，然后暂停0.5秒的空气，最后是2秒的呼气阶段。测试周期见图8.8。





除了对1L肺进行的呼气测试外，还对一个明显较小的、模拟婴儿肺的肺进行了少量的测试案例。最后，使用了一个人类肺，其中一名论文工作者试图只使用该系统呼吸。婴儿肺和人的肺都没有被用于呼气系统模型的验证，但被用于分析PI控制器的性能。为验证而进行的6项试验作为结果章分析的基础，见下表8.4。





## 8.5 结果和讨论





在本节中，将介绍关于静态和动态测试的呼气系统模型的结果。本章不涉及系统的行为，而是在上一章中介绍和讨论。本文将介绍模型行为的准确性，并分析模型是否足够准确，以及一些可以实现的改进或改变的建议。由于呼气系统模型的复杂性，讨论将集中在整个模型，而不是单独的模型部分，如执行器和气体链模型。这些子系统的性能和准确性将在前面的章节中进行了介绍。





### 8.5.1 结论





对系统进行了静态测试，以测量和验证模型中使用的具体参数。然后将动态测试作为验证和估计仿真精度的主要数据。





进行了三种不同的静态测试，在测试之间，其执行器的输入电压发生变化。表8.5显示了在单独测试的电压输入条件下，模拟系统与物理系统之间的相对误差。





为了说明静态测试的结果，静态测试2如图8.9所示。左图为整个测试过程，右图为测试用例的中点，从中可以找到肺压力的最大相对误差。





从这些数据来看，在一定程度上可以验证作用在膜上的力。仿真与物理系统的差异可以表明模型中的力估计是过高还是过低。如果模拟压力持续低于测试数据，则实际的阀开度很高，这也表明实际作用在膜上的开启力很高。





对于动态测试，进行了更广泛的测试，并在硬件循环测试程序部分进行了更详细的解释。为了得到模型精度的总体估计，在整个测试期间计算了测试数据与仿真数据之间的平均相对误差。表8.6给出了6种不同的试验以及压力的平均相对误差。所有测试都与循环中的硬件测试程序部分中提供的测试相同。





为了获得可视化表示，上表中列出的测试4如图8.10所示。





从图中可以看出，测试数据在吸入点有一个巨大的压力峰值，这是由于在HIL设置中使用的吸入气体模块的参考流量的突然变化而引起的。这种现象没有在呼气系统模型中建模，从而导致较高的相对误差。





为了充分分析模型的准确性，我们分别分析了呼吸周期的关键周期。本文给出了系统的升降时间、超调和振荡频率，并比较了输入电压、肺和阀的压力以及呼气流量。





对于呼吸周期的吸入期，物理气体模块及其控制结构的行为并不是呼气系统模型的一部分。因此，如图8.10中可以在时间4秒时看到的峰值，因此不被认为是模型精度的一个兴趣点。吸入时，肺和阀的压力如图8.11所示，其中分析了上升时间和超调以及振荡行为。





如图8.11所示，物理系统的上升时间在1.1 s左右。下图8.12显示了吸入结束时的振荡行为。





图中显示了当流量突然变化时，模拟阀的压力与物理系统具有相同的振荡趋势。然而，模拟也表明，与物理系统相比，频率有微小的差异，因为它的压力以较高的频率振荡。在吸气阶段之后，就开始了一个暂停期，假设系统中没有泄漏，那么肺和阀内的压力应该保持不变。这里模拟的肺压力和阀压力都存在小于物理系统的、约1.4%的稳态误差。





在呼吸周期的最后一部分，系统呼出肺。由于这一阶段被控制，系统的进一步分析是可能的，除了压力外，其中的电压和呼气流量也可以研究。在呼气开始时，控制器通过拉下膜来打开阀门，产生了一个巨大的流量变化。这将导致控制阀压力在低于参考呼气末正压时出现过超调。这就导致了阀门压力和呼气流量的振荡。这些行为如图8.13所示。





对于吸入阶段，模型系统显示了物理系统的动态行为，物理系统的频率略高，差异最大达15%。结果表明，控制信号，即电压，与物理系统具有相同的幅度，峰值略低。模拟模型的呼气流量在呼气开始时达到相同的峰值，但显示出更激进的第二个峰值，其超过测试数据约10%。至于流量和电压，阀门的压力在呼气开始时发生振荡。这里的模型比物理系统更激进一些，在第一个峰值处发现的最大相对误差约为30%。模拟肺压下降时间低于实际系统，说明顺应性较低，导致肺压力下降较慢。





最后，检查呼吸周期的稳态时间，其中压力和流量开始达到最终值。当控制压力达到其稳态时，系统的振荡已经停止，如图8.14所示。





电压表明，与物理系统相比，模拟系统需要稍低的电压以保持呼气末正压值，但也显示出遵循实际系统的动态行为的趋势。阀压力和流量[l/min]压力都随着振荡的停止而增加，这是添加到模型中的泄漏模型的副作用。模拟和物理系统之间的差异和相似之处，提出了差异的原因，以及如何改进它的建议。





### 8.5.2 讨论





从静态试验中可以得出三个不同的结论。首先，最重要的是，所有的相对误差都显著低于10 %，这意味着整个呼气系统模型在静态情况下可以被认为足够准确。





在阀全开的情况下，阀的相对误差最大。然而，对于一个完全打开的阀门，最小流量的压力水平低于信号噪声幅度。如果不考虑这些值，则平均相对误差从7.6下降到小于3%。阀全开的结果表明，阀门流量模型和气体链模型可以足够准确地估计系统内的流量和压力损失。





最后，另外两个使用−0.25和−0.5V电压的静态测试的误差很小，如果真实和模拟的阀门开口匹配不密切，就无法实现该误差。这表明，VCA和阀的力模型具有足够高的精度来预测系统的物理行为。即使是膜预张力中的一个小误差也对静态试验有显著的影响，因为它对阀门的打开有直接的影响。





动态测试表明，模拟模型描述了物理系统的所有基本动力学。吸气结束和呼气开始时的振荡频率差异显眼，但不显著。最显著的差异是吸气结束时的压力不同和呼气结束时的压力下降。





不同的压力峰值可以解释为肺的顺应性非恒值。从图8.11中可以清楚地看到效果的变化，因为测试阀压力的增加是非线性的。





第一次动态测试表明，呼气末正压在测量和模拟数据之间差异一致。除了当压力接近呼气末正压设定值时外，系统的动态行为与之前所呈现的路径完全相同。在这里，模拟的模拟压力几乎上升到设定的呼气末正压，而测试数据下降到较低的呼气末正压。该现象如图8.15所示。该现象是由于6.4中讨论的各种原因导致的泄漏流造成的。





为了解释压降，对气链引入了一个简单的泄漏模型。介绍泄漏影响（8.3），修改后的版本显示在（8.6）中。所介绍的泄漏模型见（8.7）。





$$ (8.6) (8.7) $$





其中，Cleak是泄漏流量因子，kx和kF是将该泄漏流量因子在0和1之间平稳缩放的比例因子。这些因素的限制是





$$ (8.8) (8.9) $$





泄漏因子和法向力和间隙的阈值都是手动调整的。引入泄漏模型修正了模拟和实验的peep终值的差异。然而，简单的泄漏模型并不能描述呼气的不同动态。





无论仿真模型中存在轻微误差，最终结果都是优秀的。仿真模型捕捉了系统的静态和动态特性，因此可以得出结论，解析、参数VCA和阀门模型足够准确，可以探索不同阀门和控制方案的动态特性。





## 9 系统设计





基于从测试系统中获得的知识以及基于模型的仿真，本章旨在深入了解一些设计解决方案是如何影响整体性能。本章提出的解决方案仅基于本文前面提出的模型，仿真是得出所有结论的基础。基于本章中给出的建议，以执行器、膜和阀门设计的形式给出了一个完整的呼气系统设计建议。对该系统进行了仿真和测试，并与本文中使用的物理测试系统进行了比较。





## 9.1 阀设计





为了演示和探索所开发的模型的能力，进行了一个样例阀门的设计。本设计基于本文中使用的uTurn阀设计。本章中所讨论的各种设计问题是





阀门入口直径应该有多大？


膜的刚度如何影响阀门的性能？


模块质量如何影响阀门的性能？


非活动阀门的压力损失如何？


阀膜预张有什么好处吗？


将薄膜连接到执行器上有好处吗？





阀门的入口直径会影响压力损失、通过阀的流量以及对阀膜施加的力。选择12…28mm进行研究。所有阀的输入直径均设置为20mm，出口直径设置为22mm。





第一个有趣的因素是，考虑到固定流量通过导致的压力损失和阀直径，阀的间隙需要多大。比较了输送200l/min时其压力损失为10hPa的状况。早期的工作使用了间隙不应该超过阀门直径的25%的假设，因此这被包括在结果中。通过计算导数来衡量阀门直径的进一步增加会使差异有多大变化。这些结果如图9.1所示。





影响阀门直径选择的第二个因素是施加在阀膜上的力。系统要求规定，阀门上的最大压力为120hPa。最大力由确定阀全关和有流量决定。这些结果如图9.2所示。





结果图9.1显示，增加阀门直径会减少所需的间隙开度。如果直径大于13.2 mm，则所需的间隙小于直径的25%。根据要求，阀门直径小于该值是不可行的，因此不需要阀门开度大于3.3mm。随着阀的直径增大，所需的间隙迅速减小，直到阀门直径达到∼15mm，之后下降速率保持相当低和稳定。





与之相反，施加在膜上的力随着阀门直径的增加而并排增大。因此，最大可行阀直径由最大可接受力确定。对于阀门直径为13.2mm，所需的力为2.15 N。最大可接受力为3N，对应的阀门直径为16.4mm。根据图9.1，一个直径最大（16.4mm）的阀门需要的间隙为2.4 mm。我们选择了13.2 mm和16.4 mm这两个极端来进行进一步的研究。





系统要求之一是，在30l/min的流量下，阀的压力损失不得大于3hPa。被动的压力损失受阀门直径、膜的刚度和预张力或对阀座的偏移的影响。被动压力损失也代表了在膜没有连接到执行器的设计中可达到的最低静压损失。膜的附着问题将在本章的后面进行讨论。





被动压力损失评估为30和200l/min，对三种不同的情况：膜紧靠阀座，预紧薄膜紧靠阀座，薄膜与阀座存在偏移。计算结果如图9.3和图9.4所示。





图显示，较大的阀门的压力损失显著降低。增加膜的刚度和增加预张力均会增加压力损失。膜具有偏移量可以减少刚度较大膜的压力损失，而对于更灵活的膜，差异不那么显著。膜的刚度过高意味着无法在没有压力损失过高的情况下被动地提供200l/min的最大流量。





对于13.2和16.4 mm阀门，最硬的膜的弹性常数分别为50和100N/m。对于直径较大的材料，创建一个柔性膜应该更容易。这与较低的灵活性要求相结合，说明有利于更大的阀门。





结果表明，膜的预张状态应当避免。对可行的刚度，添加一个偏移量并不能显著改善压差。此外，增加一个偏移量很可能会降低所需的止回阀的功能。





根据本节的所有结果，使用柔性膜、直径为16.4mm的阀将是最佳的选择。对于最佳的膜刚度还没有明确的结论。然而，现有膜的测量值略过小，其刚度为∼40 N/m。因此，可以得出结论，在阀座上放置一个40N/m的膜是一个可行的选择。





## 9.2 VCA设计





由于呼气的要求是针对压力和流量的，因此对VCA设计的要求直接基于阀的设计。该阀门说明了满足呼出阶段要求所需的力和最大电机冲程。根据上一节中给出的在阀早期设计中的建议，执行器的峰值力必须至少为2.95 N，行程最小为2.4mm。





在本节中，我们介绍了针对这些要求的执行器设计，以及对不同参数如何影响执行器行为的一些见解。本文将包括以下几点。





建议的音圈设计。


是悬垂或下悬线圈首选？


移动质量块如何影响性能？


不同的磁铁和线圈尺寸如何影响作用力？


具有非线性执行器的影响？





声圈运动部分的质量会影响到三个不同部分的行为。第一个是执行器的响应时间，即它到达行程顶部的速度。为了检测质量及其影响，质量从2g增加到32g。质量到达最终位置的时间如图9.5所示。





从图中可以看出，响应时间随着质量的增加而增加，说明质量增加了一倍，响应时间增加了40%。另一方面，假设重力是唯一的影响因素，随着质量增大，峰值力的减小幅度是相同的。根据线圈的方向和轴对准的精度，质量的增加会对系统的摩擦产生显著影响。这反过来也影响了执行器的响应时间和峰值力。然而，在本文中，质量位置的假设是，执行器的方向设置为向上，允许轴尽可能自由地移动。





对于长音圈或短音圈之间的比较，方程2.1是一个很好的分析开始。在这个方程中可以看出，力直接受到导线的长度和磁通量的影响，而不考虑在这个比较中的电流。为了保证执行器的力不变，当减少两个中的一个时，另一个则增加。





对于一个短音圈，这表明永磁铁必须更强，以保持与一个长音圈相同的力，假设两者都有相同数量的线圈层。根据VCA的实现，两种方式都是首选，然而，短音圈需要使用更昂贵的执行器设计，而长音圈提供更少的线性行为和更高的线圈电感和电阻。由于VCA所需的力较小以及短冲程，在本文将使用短音圈，因为执行器可以较小，所需的电机行程可以保证线性。





执行器的非线性部件是否会影响控制性能，这取决于控制器的设计和所需的电机冲程。如阀门设计部分所给出的，设计所需的最大电机行程约为3.3mm。这表明在呼气系统中，电机行程相对较低。在图9.6中可以看出，对于一般的VCA，电机可以被偏移到电机冲程相对线性的位置中。





然而，为了确保控制器的稳定性，这些区域的扩展取决于执行器的设计。基于VCA理论章节，可以找到一些关于VCA的不同部分如何影响力输出的见解。永磁体的长度可增加其工作点，允许更好的效率，但也增加了通量泄漏。另一方面，直径则相反，它降低了磁体的工作点，但随着磁体面积和间隙面积之间的比例的增加，增加了间隙中的通量密度。放置在磁铁顶部的极片产生了闭环电路。极片厚度或直径的增加增加了间隙面积，从而导致通量密度降低。然而，极片厚度也直接影响执行器的线性跨度。杆件越厚，执行器的线性行程就越大。另一方面，对于轭件，方程式表明，轭件的尺寸对执行器的力没有显著影响。





在设计执行器时，杆和轭件必须考虑一个因素，即确保外壳磁通不会饱和。对于这个公式9.1，可以用来估计最小厚度





$$ (9.1) $$





其中Bsat是板的饱和通量密度。





根据刚才提到的研究结果和阀门的要求，模拟了音圈的建议设计.峰值力选择在3.4N左右，线性面积为2毫米。在设计中，假设Bsat板的饱和度为1.5T，因此，允许的最小极片厚度为4.7mm左右。力作为位置的函数如图所示





在这种设计中，线圈有3毫米的铜线，在移动质量块上包裹了三层。导线直径为0.1875 mm，使得总导线长度为4.9 m，导致线圈电阻约为3Ω。在轭和极片之间放置有磁化等级N48的钕磁铁。执行器的尺寸如图9.8所示。





## 9.3 膜连接





对于膜的设计，阀的设计部分已经涵盖了一些部件。然而，在本节中，设计选择是将膜连接到执行器或使其自由悬挂。为此，我们将提出以下两部分。





一种可能的机械附着解决方案。


附件对系统的影响。





是否附着膜有优点也有缺点。如果声圈被机械地连接到膜上，该设计允许执行器通过推动和拉动膜来控制阀的开启。这将允许呼气控制器有一个更快的反应时间，而不必依赖呼气压力来打开阀门。





本文中讨论但未实现的一个解决方案是通过一个球形连接来连接这两个系统。其想法是，在呼气过程中，从执行器中传递一个高于工作力的力，以锁定两个系统之间的连接。与更固定的机械附件相比，连接的球形形状将允许两个系统更自由地移动，这意味着球形连接将允许执行器和膜之间的一些相对的横向运动。





但是，这个解决方案可能会给系统造成一些问题。通过允许两个系统之间的一些自由运动，可能会影响执行器的摩擦。如果附件与中心轴错位，可能会产生侧力，导致摩擦增加。





## 9.4 设计性能





对于建议的阀门和音圈设计，我们将该设计与本报告前面使用的HIL测试系统进行了比较。进行比较是为了了解这些更改是否按照预期提高了系统性能。除此之外，建议的设计还被用于分析不同的设计方面如何影响控制性能。本节将对以下进行探讨和分析。





非线性执行器是否会影响控制性能？


连接膜和执行器是否能提高控制性能？


执行器的质量如何影响控制性能？


更高的执行器阻尼如何影响控制性能？


比较设计建议与HIL测试系统的系统性能





观察使用线性和非线性执行器的控制性能，执行器的可能设计应该作为回答这个问题的一个兴趣点。建议的阀门设计表明，执行器的工作范围相对较小，电机冲程小于3mm。如执行机构设计部分所示，可以设计一个具有线性特性行程的执行器。这本身就表明，只要操作线圈被偏移到线性区域内，就可以使用非线性执行器。但为了进一步研究使用非线性执行器的可能性，我们进行了两个模拟，分析了线圈位于线性区域内外的控制性能。这两个测试的结果见图9.9。





这些图显示了恒力系数和位置相关系数之间的比较。虚线表示非线性执行器仿真，实线表示线性执行器。在这个测试中，呼气末正压设置为200Pa，流量为4l/min，这是低压对非线性的最大影响。从正确的图中可以看出，稳定值的差异很小，小于1%，控制器的特性仍然保持不变。这表明，如果执行器在恒定区域之外运行，控制性能不会受到任何显著的影响。





为了估计建议的呼气系统设计的性能，将这些模拟与物理HIL系统进行了比较。这表明了该设计是否真的如预期的那样提高了性能。结合这一比较，对测试了要求的极限进行了模拟。





为了比较两种系统，对建议的设计模拟了相同的测试用例，并在HIL系统上进行了物理测试。试验案例包括呼气末正压值为600 P a，吸气流量为8l/min，试验肺容量为1l。除了新的设计外，模拟膜采用自由悬挂，实现了简单的泄漏模型和传统的PI控制器。这两个系统的系统响应如图9.10所示。





图中表明，建议的设计响应时间与物理系统略有相同。由于控制器不能将胞膜打开，预计会有一些较慢的响应。在压力图（底部）中可以注意到，建议设计的稳态误差较小。这可以追溯到更快的响应，由超调表示。更快的响应允许系统进行更快的补偿，因此在泄漏降低压力之前到达正确的稳态值。电压图（左）表示在呼气阶段（6个时间6-8秒和10-12秒之间），建议的设计具有较低的功率消耗。为了进一步评估这两个系统的动力学行为，流动和压力中的振荡如图9.11所示。这些振荡出现在呼气阶段开始时，可以在6秒和10秒的图中找到。





分析这些数字，建议的设计有较低的振荡的流量和压力。压力的超调允许控制器响应更快，而低执行器质量和膜刚度减少了振荡。





作为呼气系统设计的最终分析点，测试了压力和流量的极端值。在这些模拟中，呼气末正压被设置为5000 P a，吸气流为35l/min，导致PAP约为5080 Pa。系统响应如图9.12所示。





如图9.12所示，控制器对系统很激进。这种行为将在报告的控制部分进行更详细的解释。为了分析系统的响应，通过降低比例部分来降低控制器的激进性。这就给出了一个如图9.13所示的更稳定的系统。





图示表明，当新呼吸开始前肺压达到呼气末正压值时，系统满足要求。在控制呼气期间，执行器的电压约为1V，在压力和流量中没有振荡。





将膜和执行器是否相互连接的问题严重影响了阀门的最终设计和实施。连接可以允许更快的执行器和更好的整体控制，使控制膜运动到两个方向。然而，连接会增加系统的复杂性。附件的设计提出了一个重大的设计挑战，因为必须以最小的影响进行连接。在呼气系统模型测试的早期，人们意识到连接会增加膜的错位和执行器上的侧向力，从而使控制更加困难。





为了评估膜连接是否提供足够的好处，对连接膜和非连接膜进行了比较。连接膜的最大好处是在低压，因为推动膜可以允许更快的响应时间。因此，对PEEP和PAP分别为1和5.8hP a进行了模拟。非附着膜是通过设置最小控制电压为零来实现的，这意味着执行器只能推动膜。仿真结果见9.14。





如预期的那样，对连接的膜的驱动速度更快。然而，使用使用过的控制器，阀门压力的快速下降会导致在前0.1秒内出现更高的超调，之后未附着的膜会赶上。由于电压较高，附着膜也有更多的振动和功耗，最后肺内的压差最大值仅为30Pa。基于单一模拟，连接膜似乎不能提供足够的性能提升来弥补其缺点。





在PEEP和PAP分别为10和16.5 hP a的情况下，模拟了质量和阻尼的影响。一个显著较高质量的测试和一个显著阻尼的测试，与质量和阻尼都较低的情况进行了比较。测试结果如图9.15所示





从一个单一的测试中无法得出最终的结论。然而，增加阻尼和质量都显著地使控制响应明显变慢。增加质量也使控制不稳定。质量或阻尼的微小变化不太可能导致系统性能的显著差异。该控制器可以被设计成使系统以牺牲响应时间为代价，响应更加稳定。为了实现尽可能快的响应，质量和阻尼都应保持较低。





## 10 总结





## 10.1 总结





本文建立了音圈执行器、膜阀和呼吸机完整呼气系统的分析模型，使基于模型的呼气阀得以发展。所开发的VCA-和阀模型允许快速比较多种不同的设计，而不需要一个物理原型。然而，在选择最终设计和设计系统控制之前，VCA和阀门都应该是原型，因为系统的每个部分都包含了一些不确定的来源。





通过估计空隙外和空隙内的通量密度，可以对VCA的力-位置依赖性进行足够精确的分析建模。然而，测试表明，不同的边通近似应使用内部和外部的执行器。





随着VCA设计开始偏离传统设计，模型也没有捕捉到执行器的动态行为。因此，模型的精度需要基于执行器设计为一个闭环电路的假设。





执行器作用在质量上的力主要是由气隙中的通量密度贡献的，加上较低的峰值力要求，首选采用短音圈设计。执行器的质量对致动器本身的性能没有显著影响，但会在呼气系统中引起振荡。





本文中使用的控制器主要是为了对模型进行验证。所实施的结构不满足整个流量和压力范围的要求。





膜阀的建模必须分为通过阀的体积流量和施加在膜上的力。通过阀的流量取决于阀门的几何形状外、压差和阀开度。通过一个典型的呼气阀的流量可以被认为是不可压缩的，并且可以使用大于0.1mm的阀门开口来可靠地建模。对于比这更小的开口，膜可能的错位和变形发挥更大的作用，模型不存在无法解释的小泄漏流。





膜上的力可以通过近似膜上的压再分配来最好地模拟。即使模型给出的力近似很好，但由于湍流，膜上的压力分布不能被认为是准确的。本文所建立的力模型只能在三个原型阀中的两个上进行验证，因为阀门几何形状的差异会极大地影响所施加的力。





本文所建立的流动模型和力模型都是基于膜上压力分布的近似值。另一方面，压力分布依赖于流动和流动方向，因此在流动流向相反的情况下不能使用该模型。





仿真结果表明，非线性执行器对控制性能没有显著影响。首先，执行器可以设计为为所需的行程产生恒定的力，其次，即使执行器的力随着质量位置的变化，短电机行程的控制性能变化也不显著。

































































